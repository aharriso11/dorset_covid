labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100))
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "deepskyblue4"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
theme_bw() +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100))
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "blue4"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
theme_bw() +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100))
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
theme_bw() +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100))
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_base()
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_fivethirtyeight()
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_bw()
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_classic()
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_clean()
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_clean()
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Percent of people aged 12 and over that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_clean()
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Percent of people aged 12 and over that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_clean() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Percentage of people aged 12 and over that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_clean() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Percentage of people aged 12 and over that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_bw() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Percentage of people aged 12 and over that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_clean() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
covid_vaccs_percentage_plot
covid_vaccs_dor <- read.csv(url("https://api.coronavirus.data.gov.uk/v2/data?areaType=ltla&areaCode=E06000059&metric=newPeopleVaccinatedFirstDoseByVaccinationDate&metric=newPeopleVaccinatedSecondDoseByVaccinationDate&metric=newPeopleVaccinatedThirdInjectionByVaccinationDate&format=csv"))
View(covid_vaccs_dor)
covid_vaccs_bcp <- read.csv(url("https://api.coronavirus.data.gov.uk/v2/data?areaType=ltla&areaCode=E06000058&metric=newPeopleVaccinatedFirstDoseByVaccinationDate&metric=newPeopleVaccinatedSecondDoseByVaccinationDate&metric=newPeopleVaccinatedThirdInjectionByVaccinationDate&format=csv"))
# merge datasets into one
# 1 - place datasets into a single list
vaccs_list <- list(covid_vaccs_bcp,covid_vaccs_dor)
# 2 - merge the datasets in the list into vaccs_combined
vaccs_combined <- merge_recurse(vaccs_list)
# keep only the columns we need, and rename the vacc event columns
vaccs_combined <- subset(vaccs_combined, select = c("date", "areaName", "newPeopleVaccinatedFirstDoseByVaccinationDate", "newPeopleVaccinatedSecondDoseByVaccinationDate", "newPeopleVaccinatedThirdInjectionByVaccinationDate"))
names(vaccs_combined)[names(vaccs_combined) == "newPeopleVaccinatedFirstDoseByVaccinationDate"] <- "First"
names(vaccs_combined)[names(vaccs_combined) == "newPeopleVaccinatedSecondDoseByVaccinationDate"] <- "Second"
names(vaccs_combined)[names(vaccs_combined) == "newPeopleVaccinatedThirdInjectionByVaccinationDate"] <- "Third or booster"
View(vaccs_combined)
# define the date format
vaccs_combined$date = as.Date(vaccs_combined$date, "%Y-%m-%d")
# convert wide data into long
vaccs_long <- gather(vaccs_combined, event, total, First:last_col())
# create plot and geom
covid_vaccs_plot <- ggplot() +
geom_bar(data = vaccs_long, aes(x = date, y = total, fill = event), stat="identity", position = "stack", width = 0.7) +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
theme_bw() +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Vaccinations")
covid_vaccs_plot
# create plot and geom
covid_vaccs_plot <- ggplot() +
geom_bar(data = vaccs_long, aes(x = date, y = total, fill = event), stat="identity", position = "stack", width = 0.7) +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
theme_bw() +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Daily numbers of new people that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations")
covid_vaccs_plot
# create plot and geom
covid_vaccs_plot <- ggplot() +
geom_bar(data = vaccs_long, aes(x = date, y = total, fill = event), stat="identity", position = "stack", width = 0.7) +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Daily numbers of new people that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
theme_clean()
covid_vaccs_plot
# create plot and geom
covid_vaccs_plot <- ggplot() +
geom_bar(data = vaccs_long, aes(x = date, y = total, fill = event), stat="identity", position = "stack", width = 0.7) +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Daily numbers of new people that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
theme_bw()
covid_vaccs_plot
# save to daily file
ggsave("output/daily_dorset_vaccinations.png", width = 16.6, height = 8.65, units = "in")
# Use pacman to install (if req) and load required packages
pacman::p_load(
ggplot2,
tidyr,
reshape,
lubridate
)
# restrict to last 9 months
vaccs_combined <- subset(vaccs_combined, date > today() - months(9))
# convert wide data into long
vaccs_long <- gather(vaccs_combined, event, total, First:last_col())
# create plot and geom
covid_vaccs_plot <- ggplot() +
geom_bar(data = vaccs_long, aes(x = date, y = total, fill = event), stat="identity", position = "stack", width = 0.7) +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Daily numbers of new people that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
theme_bw()
covid_vaccs_plot
# restrict to last 9 months
vaccs_combined <- subset(vaccs_combined, date > today() - months(6))
# convert wide data into long
vaccs_long <- gather(vaccs_combined, event, total, First:last_col())
# create plot and geom
covid_vaccs_plot <- ggplot() +
geom_bar(data = vaccs_long, aes(x = date, y = total, fill = event), stat="identity", position = "stack", width = 0.7) +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%B %Y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Daily numbers of new people that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
theme_bw()
covid_vaccs_plot
# create plot and geom
covid_vaccs_plot <- ggplot() +
geom_bar(data = vaccs_long, aes(x = date, y = total, fill = event), stat="identity", position = "stack", width = 0.7) +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("Dorset covid vaccinations by local authority") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Daily numbers of new people that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
theme_bw()
covid_vaccs_plot
# set working directory
setwd("~/Documents/GitHub/dorset_covid")
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
ggplot2,
tidyr,
reshape
)
vaccs_percentage_dor <- read.csv(url("https://api.coronavirus.data.gov.uk/v2/data?areaType=ltla&areaCode=E06000059&metric=cumVaccinationFirstDoseUptakeByVaccinationDatePercentage&metric=cumVaccinationSecondDoseUptakeByVaccinationDatePercentage&metric=cumVaccinationThirdInjectionUptakeByVaccinationDatePercentage&format=csv"))
vaccs_percentage_bcp <- read.csv(url("https://api.coronavirus.data.gov.uk/v2/data?areaType=ltla&areaCode=E06000058&metric=cumVaccinationFirstDoseUptakeByVaccinationDatePercentage&metric=cumVaccinationSecondDoseUptakeByVaccinationDatePercentage&metric=cumVaccinationThirdInjectionUptakeByVaccinationDatePercentage&format=csv"))
# merge datasets into one
# 1 - place datasets into a single list
vaccs_percentage_list <- list(vaccs_percentage_dor, vaccs_percentage_bcp)
# 2 - merge the datasets in the list into vaccs_combined
vaccs_percentage_combined <- merge_recurse(vaccs_percentage_list)
# keep only the columns we need, and rename the vacc event columns
vaccs_percentage_combined <- subset(vaccs_percentage_combined, select = c("date", "areaName", "cumVaccinationFirstDoseUptakeByVaccinationDatePercentage", "cumVaccinationSecondDoseUptakeByVaccinationDatePercentage", "cumVaccinationThirdInjectionUptakeByVaccinationDatePercentage"))
names(vaccs_percentage_combined)[names(vaccs_percentage_combined) == "cumVaccinationFirstDoseUptakeByVaccinationDatePercentage"] <- "First"
names(vaccs_percentage_combined)[names(vaccs_percentage_combined) == "cumVaccinationSecondDoseUptakeByVaccinationDatePercentage"] <- "Second"
names(vaccs_percentage_combined)[names(vaccs_percentage_combined) == "cumVaccinationThirdInjectionUptakeByVaccinationDatePercentage"] <- "Third or booster"
# define the date format
vaccs_percentage_combined$date = as.Date(vaccs_percentage_combined$date, "%Y-%m-%d")
# convert wide data into long
vaccs_percentage_long <- gather(vaccs_percentage_combined, event, total, First:last_col())
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Percentage of people aged 12 and over that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_clean() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
covid_vaccs_percentage_plot
# save to daily file
ggsave("output/daily_dorset_vaccs_percentage.png", width = 16.6, height = 8.65, units = "in")
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Percentage of people aged 12 and over that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_bw() +
theme(
plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Percentage of people aged 12 and over that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_bw() +
theme(
plot.title = element_text(size = 26, face = "bold"),
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Percentage of people aged 12 and over that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_bw() +
theme(
plot.title = element_text(size = 26, family = "Helvetica", face = "bold"),
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Percentage of people aged 12 and over that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_bw() +
theme(
plot.title = element_text(size = 20, family = "Helvetica", face = "bold"),
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Percentage of people aged 12 and over that have received a COVID-19 vaccination.") +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_bw() +
theme(
plot.title = element_text(size = 20, family = "Helvetica", face = "bold"),
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 11),
plot.caption = element_text(size = 10))
covid_vaccs_percentage_plot
# create plot and geom
covid_vaccs_percentage_plot <- ggplot() +
geom_area(data = vaccs_percentage_long, aes(x = date, y = total, group = event, fill = event), position = "dodge") +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "2 months") +
ggtitle("Dorset covid vaccinations by local authority - population percentage over time") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Percentage of people aged 12 and over that have received a COVID-19 vaccination") +
xlab("Date") +
ylab("Vaccinations") +
scale_y_continuous(breaks = c(20, 40, 60, 80, 100), labels = scales::percent_format(scale = 1), limits = c(0,100)) +
theme_bw() +
theme(
plot.title = element_text(size = 20, family = "Helvetica", face = "bold"),
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 11),
plot.caption = element_text(size = 10))
covid_vaccs_percentage_plot
# set working directory
setwd("~/Documents/GitHub/dorset_covid")
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
ggplot2,
tidyr,
reshape,
lubridate
)
covid_vaccs_dor <- read.csv(url("https://api.coronavirus.data.gov.uk/v2/data?areaType=ltla&areaCode=E06000059&metric=newPeopleVaccinatedFirstDoseByVaccinationDate&metric=newPeopleVaccinatedSecondDoseByVaccinationDate&metric=newPeopleVaccinatedThirdInjectionByVaccinationDate&format=csv"))
covid_vaccs_bcp <- read.csv(url("https://api.coronavirus.data.gov.uk/v2/data?areaType=ltla&areaCode=E06000058&metric=newPeopleVaccinatedFirstDoseByVaccinationDate&metric=newPeopleVaccinatedSecondDoseByVaccinationDate&metric=newPeopleVaccinatedThirdInjectionByVaccinationDate&format=csv"))
# merge datasets into one
# 1 - place datasets into a single list
vaccs_list <- list(covid_vaccs_bcp,covid_vaccs_dor)
# 2 - merge the datasets in the list into vaccs_combined
vaccs_combined <- merge_recurse(vaccs_list)
# keep only the columns we need, and rename the vacc event columns
vaccs_combined <- subset(vaccs_combined, select = c("date", "areaName", "newPeopleVaccinatedFirstDoseByVaccinationDate", "newPeopleVaccinatedSecondDoseByVaccinationDate", "newPeopleVaccinatedThirdInjectionByVaccinationDate"))
names(vaccs_combined)[names(vaccs_combined) == "newPeopleVaccinatedFirstDoseByVaccinationDate"] <- "First"
names(vaccs_combined)[names(vaccs_combined) == "newPeopleVaccinatedSecondDoseByVaccinationDate"] <- "Second"
names(vaccs_combined)[names(vaccs_combined) == "newPeopleVaccinatedThirdInjectionByVaccinationDate"] <- "Third or booster"
# define the date format
vaccs_combined$date = as.Date(vaccs_combined$date, "%Y-%m-%d")
# restrict to last 9 months
vaccs_combined <- subset(vaccs_combined, date > today() - months(6))
# convert wide data into long
vaccs_long <- gather(vaccs_combined, event, total, First:last_col())
# create plot and geom
covid_vaccs_plot <- ggplot() +
geom_bar(data = vaccs_long, aes(x = date, y = total, fill = event), stat="identity", position = "stack", width = 0.7) +
scale_fill_manual(name = "Vaccination", values = c("First" = "paleturquoise3", "Second" = "turquoise4", "Third or booster" = "#00413d"), labels = c("First", "Second", "Third or booster")) +
facet_grid( ~ areaName) +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("Dorset covid vaccinations by local authority") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = "Daily numbers of new people that have received a COVID-19 vaccination") +
xlab("Date") +
ylab("Vaccinations") +
theme_bw() +
theme(
plot.title = element_text(size = 20, family = "Helvetica", face = "bold"),
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 11),
plot.caption = element_text(size = 10))
covid_vaccs_plot
# save to daily file
ggsave("output/daily_dorset_vaccinations.png", width = 16.6, height = 8.65, units = "in")
source('~/Documents/GitHub/dorset_covid/scripts/covid dorset vaccs percentage.R', echo=TRUE)
