# subtitle element must be markdown to display html
plot.subtitle = element_markdown(hjust = 0, vjust = -0.1),
)
covid_cases_pos_plot
# set working directory
setwd("~/Documents/GitHub/dorset_covid")
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
ggplot2,
dplyr,
zoo,
lubridate,
ggthemes
)
covid_cases_csv <- read.csv(url("https://api.coronavirus.data.gov.uk/v2/data?areaType=nation&areaCode=E92000001&metric=newCasesBySpecimenDate&format=csv"))
covid_cases_csv <- covid_cases_csv %>%
dplyr::mutate(cases_07da = zoo::rollmean(newCasesBySpecimenDate, k = 7, fill = NA))
covid_cases_csv$date = as.Date(covid_cases_csv$date, "%Y-%m-%d")
less_recent_days <- Sys.Date() - 5
less_seven_days <- less_recent_days - 7
covid_cases_plot <- ggplot(covid_cases_csv[which(covid_cases_csv$date>today() - months(12) & covid_cases_csv$date<less_recent_days),], aes(x = date, y = cases_07da)) +
geom_point(shape = 1, colour = "red", size=2) +
geom_smooth(data=subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "))
covid_cases_plot +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
xlab("Date") +
ylab("Cases") +
theme_bw()
covid_cases_csv <- read.csv(url("https://api.coronavirus.data.gov.uk/v2/data?areaType=nation&areaCode=E92000001&metric=newCasesBySpecimenDate&format=csv"))
covid_cases_csv$date = as.Date(covid_cases_csv$date, "%Y-%m-%d")
less_recent_days <- Sys.Date() - 5
less_seven_days <- less_recent_days - 7
# calculate seven day rolling average
covid_cases_csv <- covid_cases_csv %>%
dplyr::mutate(cases_07da = zoo::rollmean(newCasesBySpecimenDate, k = 7, fill = NA))
# restrict to last twelve months
covid_cases_csv <- subset(covid_cases_csv, date>today() - months(12))
covid_cases_7 <- subset(covid_cases_csv, date < less_seven_days)
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_csv, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = covid_cases_7, aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE)
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_csv, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = covid_cases_7, aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month")
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_csv, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month")
covid_cases_plot
covid_cases_plot <- ggplot(covid_cases_csv[which(covid_cases_csv$date>today() - months(12) & covid_cases_csv$date<less_recent_days),], aes(x = date, y = cases_07da)) +
geom_point(shape = 1, colour = "red", size=2) +
geom_smooth(data=subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "))
covid_cases_plot +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
xlab("Date") +
ylab("Cases") +
theme_bw()
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_csv, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month")
covid_cases_plot
covid_cases_csv <- read.csv(url("https://api.coronavirus.data.gov.uk/v2/data?areaType=nation&areaCode=E92000001&metric=newCasesBySpecimenDate&format=csv"))
# set the date format
covid_cases_csv$date = as.Date(covid_cases_csv$date, "%Y-%m-%d")
# calculate seven day rolling average
covid_cases_csv <- covid_cases_csv %>%
dplyr::mutate(cases_07da = zoo::rollmean(newCasesBySpecimenDate, k = 7, fill = NA))
# restrict to last twelve months
covid_cases_csv <- subset(covid_cases_csv, date>today() - months(12))
# remove most recent five days
less_recent_days <- Sys.Date() - 5
less_seven_days <- less_recent_days - 7
covid_cases_csv <- subset(covid_cases_csv, date < less_recent_days)
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_csv, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month")
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_csv, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Cases") +
theme_bw()
covid_cases_plot
covid_cases_plot <- ggplot(covid_cases_csv[which(covid_cases_csv$date>today() - months(12) & covid_cases_csv$date<less_recent_days),], aes(x = date, y = cases_07da)) +
geom_point(shape = 1, colour = "red", size=2) +
geom_smooth(data=subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "))
covid_cases_plot +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
xlab("Date") +
ylab("Cases") +
theme_bw()
covid_cases_csv <- read.csv(url("https://api.coronavirus.data.gov.uk/v2/data?areaType=nation&areaCode=E92000001&metric=newCasesBySpecimenDate&format=csv"))
# set the date format
covid_cases_csv$date = as.Date(covid_cases_csv$date, "%Y-%m-%d")
# calculate seven day rolling average
covid_cases_csv <- covid_cases_csv %>%
dplyr::mutate(cases_07da = zoo::rollmean(newCasesBySpecimenDate, k = 7, fill = NA))
# restrict to last twelve months
covid_cases_csv <- subset(covid_cases_csv, date>today() - months(12))
# remove most recent five days
less_recent_days <- Sys.Date() - 5
less_seven_days <- less_recent_days - 7
covid_cases_plot <- ggplot(covid_cases_csv[which(covid_cases_csv$date>today() - months(12) & covid_cases_csv$date<less_recent_days),], aes(x = date, y = cases_07da)) +
geom_point(shape = 1, colour = "red", size=2) +
geom_smooth(data=subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "))
covid_cases_plot +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
xlab("Date") +
ylab("Cases") +
theme_bw()
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_csv, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Cases") +
theme_bw()
covid_cases_plot
covid_cases_subset <- subset(covid_cases_csv, date < less_recent_days)
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Cases") +
theme_bw()
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Cases") +
theme_fivethirtyeight()
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Cases") +
theme_base()
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " ")) +
xlab("Date") +
ylab("Cases") +
theme_base()
covid_cases_plot
# Use pacman to install (if req) and load required packages
pacman::p_load(
ggplot2,
dplyr,
zoo,
lubridate,
ggthemes,
ggtext
)
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(plot.subtitle = element_markdown(hjust = 0, vjust = -0.1))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). <br>Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(plot.subtitle = element_markdown(hjust = 0, vjust = -0.1))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). <br>Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(plot.subtitle = element_markdown(hjust = 0, vjust = -0.1, size = 2))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). <br>Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(plot.subtitle = element_markdown(hjust = 0, vjust = -0.1, size = 10))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). <br>Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(plot.subtitle = element_markdown(hjust = 0, vjust = -0.1, size = 11))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). <br>Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(plot.subtitle = element_markdown(hjust = 0, vjust = -0.1, size = 12))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(plot.subtitle = element_markdown(hjust = 0, vjust = -0.1, size = 12))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(plot.subtitle = element_markdown(hjust = 0, vjust = -0.1, size = 12))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = -0.1, size = 12),
plot.caption = element_text(size = 12))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = -0.1, size = 12),
plot.caption = element_text(size = 11))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0.0, size = 12),
plot.caption = element_text(size = 11))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0.5, size = 12),
plot.caption = element_text(size = 11))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 1.0, size = 12),
plot.caption = element_text(size = 11))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
covid_cases_plot
covid_cases_plot <- ggplot(covid_cases_csv[which(covid_cases_csv$date>today() - months(12) & covid_cases_csv$date<less_recent_days),], aes(x = date, y = cases_07da)) +
geom_point(shape = 1, colour = "red", size=2) +
geom_smooth(data=subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
labs(caption = paste("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted", Sys.time(), sep = " "))
covid_cases_plot +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%B %Y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
xlab("Date") +
ylab("Cases") +
theme_bw()
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11),
plot.xlab = element_text(size = 11))
covid_cases_plot
covid_cases_plot <- ggplot() +
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
covid_cases_plot
# set plot and geom
covid_cases_plot <- ggplot() +
# plot cases
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
# plot trend line
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
# set plot and geom
covid_cases_plot <- ggplot() +
# plot cases
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
# plot trend line
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
# set plot and geom
covid_cases_plot <- ggplot() +
# plot cases
geom_point(data = covid_cases_subset, aes(x = date, y = cases_07da), shape = 1, colour = "red", size = 2) +
# plot trend line
geom_smooth(data = subset(covid_cases_csv, covid_cases_csv$date >= less_seven_days), aes(x = date, y = cases_07da), method = "lm", colour = "black", size=0.5, fullrange=FALSE, se=FALSE) +
scale_y_continuous(trans = 'log10', breaks = c(1000,2000,5000,10000,20000,50000), position = "right") +
scale_x_date(date_labels = "%b %y", date_breaks = "1 month") +
ggtitle("England covid cases - 7 day average by specimen date") +
labs(caption = paste0("Data from UK Health Security Agency / https://coronavirus.data.gov.uk. Plotted ", Sys.time(), sep = " "), subtitle = paste0("Daily numbers of new cases (people who have had at least one positive COVID-19 test result). Data are shown by the date the sample was taken from the person being tested.")) +
xlab("Date") +
ylab("Cases") +
theme_base() +
theme(
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 12),
plot.caption = element_text(size = 11))
# encode url for ONS open geography portal - local authority district to region lookup (April 2021)
# url needs to be encoded so we can use it with fromJSON
region_json_url <- URLencode('https://services1.arcgis.com/ESMARspQHYMw9BZ9/arcgis/rest/services/LAD21_RGN21_EN_LU/FeatureServer/0/query?where=1%3D1&outFields=*&outSR=4326&f=json')
# get LTLA to region lookup data
region_json_data <- jsonlite::fromJSON(region_json_url)
# extract the lookup table into a dataframe
region_data <- data.table(region_json_data$features)
# Use pacman to install (if req) and load required packages
pacman::p_load(
ggplot2,
dplyr,
zoo,
reshape2,
lubridate,
plotly,
data.table,
rjson,
ggthemes,
extrafont
)
# extract the lookup table into a dataframe
region_data <- data.table(region_json_data$features)
View(region_data)
# create new dataframe to filter south west (E12000009) LTLAs only
region_data_sw <- region_data %>%
filter(attributes.RGN21CD=="E12000009")
View(region_data_sw)
